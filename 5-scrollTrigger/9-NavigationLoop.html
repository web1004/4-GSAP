<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>9-NavigationLoop</title>
  <!-- ìŠ¤í¬ë¡¤ì— ë”°ë¼ í—¤ë”ì˜ ë©”ë‰´ë°°ê²½ìƒ‰ì„ ë³€ê²½ -->
  <style>
    *{
      padding: 0;
      margin: 0;
      box-sizing: border-box;
    }
    #container{
      width: 100vw;
      height: 100vh;
    }
    section{
      height: 100vh;
      position: relative;
    }
    section:nth-child(1){background-color: #fcd768;}
    section:nth-child(2){background-color: #9edbeb;}
    section:nth-child(3){background-color: #f7baea;}
    section:nth-child(4){background-color: #abf0ca;}
    section:nth-child(5){background-color: #e6c2fa;}
    h2{
      font-size: 5vw;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%,-50%);
    }
    .nav{
      position: fixed;
      left: 0;
      top: 0;
      width: 100vw;
      /* height: 100px; */
      z-index: 999;
      background: red;
      padding: 20px 0;
    }
    .nav > ul{
      display: flex;
      list-style: none;
      justify-content: center;
      align-items: center;
      font-size: 1.5rem;     
    }
    .nav > ul > li{margin-right: 2vw;}
    .nav > ul > li > a{
      color: inherit;
      text-decoration: none;
    }
  </style>
</head>
<body>

  <nav class="nav">
    <ul>
      <li><a href="#section01">ğŸŒ± Home</a></li>
      <li><a href="#section01">ğŸ˜ŠAbout</a></li>
      <li><a href="#section02">â¬‡ï¸Product</a></li>
      <li><a href="#section03">âœ¨ Portfolio</a></li>
      <li><a href="#section04">ğŸ“¢ Contact Us</a></li>
    </ul>
  </nav>

  <div id="container">
    <section class="section section01"><h2>section1</h2></section>
    <section class="section section02"><h2>section2</h2></section>
    <section class="section section03"><h2>section3</h2></section>
    <section class="section section04"><h2>section4</h2></section>
    <section class="section section05"><h2>section5</h2></section>
  </div>


  <!-- GSAP ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì • -->
  <script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/16327/gsap-latest-beta.min.js?r=5426"></script>
  <script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/16327/ScrollTrigger.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/smooth-scrollbar/8.8.4/smooth-scrollbar.js"></script>
  <script src="js/settings.js"></script>
  <script src="js/markers.js"></script>
  <script>
    const navColor = ["#f4bf21", "#3dcbee", "#f971dc", "#47d185", "#c26df0"];
    const nav = document.querySelector(".nav");

    //(1)
    /* ScrollTrigger.create({
      trigger: '.section02',
      start: 'top top',
      end: 'bottom bottom',
      animation: gsap.to(nav,{backgroundColor:navColor[1]}),
      markers: true,
      //                E      L    EB   LB
      toggleActions: "restart none none reverse",
    }); */

    //(2)
    /* ScrollTrigger.create({
      trigger: '.section02',
      start: () => `top ${nav.offsetHeight}px`,
      end: () => `bottom ${nav.offsetHeight}px`,
      animation: gsap.to(nav,{backgroundColor:navColor[1]}),
      markers: true,
      //                E      L    EB   LB
      toggleActions: "restart none none reverse",
    }); */


    //(3)
    // const section = gsap.utils.toArray('.section').map((section) => {
    //   //console.log(section.getBoundingClientRect().top);
    //   return section.getBoundingClientRect().top
    // });

    //console.log(section);

    //const section = gsap.utils.toArray('.section').map((section) => section.getBoundingClientRect().top);

    gsap.utils.toArray(".section").forEach((section, index) => {
      //console.log(section, index);
      ScrollTrigger.create({
        trigger: section,
        start: () => `top ${nav.offsetHeight}px`,
        end: () => `bottom ${nav.offsetHeight}px`,
        //animation: gsap.to(nav,{backgroundColor:navColor[index]}),
        animation: gsap.to(nav, { backgroundColor: navColor[index],immediateRender:false }),
        markers: true,
        //                E      L    EB   LB
        toggleActions: "restart none none reverse",
      });
    });

    /* ë¬¸ì œ: ìê¾¸ ê¿ˆë²…ê±°ë¦¬ë©´ì„œ ë°”ë€Œê³  1ë²ˆ ìƒ‰ìƒì´ ì ì‹œ ë³´ì´ê³  ìˆìŒ,toëŠ” ê´œì°®ì§€ë§Œ fromì€ ëª¨ë‘ 1ë²ˆì§¸ê±°ë¡œ ì‹œì‘ì´ ë˜ê³  ìˆê¸° ë•Œë¬¸
    ëŸ°íƒ€ì„ ë Œë”ë§ : ì¦‰ì‹œ ë Œë”ë§ë˜ëŠ”ê²ƒì„ ê°•ì œë¡œ ì œì–´í• ìˆ˜ ìˆë‹¤.
    from()ê³¼ fromTo() íŠ¸ìœˆì˜ ê²½ìš°ëŠ” GSAPì€ immediateRenderë¥¼ trueë¡œ ê¸°ë³¸ê°’ì„ ê°€ì§„ë‹¤.
    immediateRenderë¥¼ falseë¡œ êº¼ë‘¬ì•¼ ìŠ¤í¬ë¡¤íŠ¸ë¦¬ê±°ê°€ ì—¬ëŸ¬ë²ˆ ìƒì„±ì´ ë˜ì—ˆì„ë•Œ to tween ì€ ë¶€í„°ì˜ ìœ„ì¹˜ë¥¼ ì œì¼ ì²˜ìŒ ì‹œì‘í•œ ë Œë”ì˜ ìœ„ì¹˜ë¡œ ì¡ì§€ ì•ŠëŠ”ë‹¤. */

    gsap.utils.toArray('.nav li').forEach((li,index) => {
      //console.log(li);
      li.addEventListener('click',()=>{
        //console.log(index);

        //scrollbar.scrollTo(0, 2000 ,600);  //2000ë§Œí¼ ì›€ì§ì„
        //scrollbar.scrollTo(0, innerHeight * index ,600);  //ì„¹ì…˜ë§ˆë‹¤ ë†’ì´ê°€ ë‹¬ë¼ì§ˆìˆ˜ ìˆìœ¼ë¯€ë¡œ
        //scrollbar.scrollTo(0, section[index] ,600); //ë¸Œë¼ìš°ì €ì˜ í¬ê¸°ê°€ ë‹¬ë¼ì§€ë©´ ì˜ ì•ˆë¨

        //console.log(ScrollTrigger.getAll()[3].start + nav.offsetHeight);
        let sectionTop = ScrollTrigger.getAll()[index].start + nav.offsetHeight;
        scrollbar.scrollTo(0, sectionTop ,600);
      });
    }); 

    //ScrollTrigger.getAll(); -> ì½˜ì†”ì—ì„œ í™•ì¸

    markers();
  </script>
</body>
</html>